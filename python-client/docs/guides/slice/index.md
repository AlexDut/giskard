# ðŸ”ª Identify data slices

Inspecting specific data slices is essential when building machine learning models. By analyzing subsets based on relevant factors, you can identify biases, disparities, and issues specific to certain groups.

:::{Slicing functions are key to integrate **domain knowlege**}
Slicing functions are not sub-datasets! They are functions that can be applied to new datasets such as your production data for testing, debugging and monitoring purposes. Saving data slices are key to integrate domain knwowledge inside your tests. 
:::

Giskard enables you to **automatically** create slicing functions, such as *low-performing*, *underconfident*, *overconfident* or *spurious data slices*. We also propose various slicing functions in the **Giskard catalog**, such as sentiment, irony or toxicity detectors. Have a look at our [ðŸ”ª Slicing Function Catalog](docs/catalogs/slicing-function-catalog/index.rst).


This section explains you how to create your own slicing function or customize the ones generated by the Giskard scan and save it.

## Generate automatically some slicing functions through the scan

Giskard enables you to automatically generate the slicing functions that are the most insightul for your ML models. You can easily extract the results of the [scan feature](docs/guides/scan/index) using the following code:

```
from giskard import Dataset, Model

my_dataset = Dataset(...)
my_model = Model(...)

scan_result = giskard.scan(my_model, my_dataset)

my_slicing_functions = scan_result["PERF3"].slicing_function
```

## Load slicing functions from the Giskard catalog

The [Giskard catalog](docs/catalogs/slicing-function-catalog) provides you different slicing function for NLP, such as sentiment, hate, toxicity detectors:
```
#Load sentiment analysis model from the Giskard catalog
from giskard.ml_worker.testing.functions.slicing import positive_sentiment_analysis
```

## Create your own slicing function

To create a Giskard slicing function, you just need to decorate an existing Python functions with `@slicing_function()`. Depending on the argument of the decorator, you can decorate different Python functions:

:::::{tab-set}

::::{tab-item} row_level=True (default)

When `row_level=True`, you can decorate a function that takes a pandas dataframe **row** as input and returns a boolean. Make sure that the first argument of your function corresponds to the row you want to filter:
```
from giskard import slicing_function, demo
import pandas as pd

_, df = demo.titanic()
dataset = Dataset(df=df, target="Survived", cat_columns=['Pclass', 'Sex', "SibSp", "Parch", "Embarked"])

@slicing_function(row_level=True)
def my_func2(row: pd.Series, threshold: int):
    return row['Age'] > threshold

dataset.slice(my_func2(threshold=20))
```
::::

::::{tab-item} row_level=False

When `row_level=False`, you can decorate a function that takes a full **pandas dataframe** as input and returns a filtered pandas dataframe. Make sure that the first argument of your function corresponds to the pandas dataframe you want to filter:
```
from giskard import slicing_function, demo
import pandas as pd

_, df = demo.titanic()
dataset = Dataset(df=df, target="Survived", cat_columns=['Pclass', 'Sex', "SibSp", "Parch", "Embarked"])

@slicing_function(row_level=False)
def my_func1(df: pd.DataFrame, threshold: int):
    df['Age'] = df['Age'] > threshold
    return df

dataset.slice(my_func1(threshold=20))
```
::::

::::{tab-item} row_level=False

When `cell_level=True` (False by default), you can decorate a function that takes as argument a **value** (string, numeric or text) and  returns a boolean. Make sure that the first argument of your function corresponds to the value and that the second argument defines the **column name** where you wants to filter the value:

```
from giskard import slicing_function, demo
import pandas as pd

_, df = demo.titanic()
dataset = Dataset(df=df, target="Survived", cat_columns=['Pclass', 'Sex', "SibSp", "Parch", "Embarked"])

@slicing_function(cell_level=True)
def my_func3(cell: int, threshold: int):
    return cell>threshold

train_df.slice(my_func3(threshold=20), column_name='Age')
```
::::
:::::


## Save your slicing function
Saving your slincing function in the Giskard server will enable you to:
* Use your slices for testing purposes: you slices can be used as *fixtures* of your test suite
* Further debug the examples inside your data slice using explanation

To upload your slicing function to the Giskard server, go to [Upload objects](docs/guide/upload/index.md) to the Giskard server.
